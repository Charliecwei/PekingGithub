function Dphip = getDphipP2jia(Dlambda,lambda)

Da1 = Dlambda(:,:,1);
Da2 = Dlambda(:,:,2);
Da3 = Dlambda(:,:,3);
Da4 = Dlambda(:,:,4);

la1 = lambda(1);
la2 = lambda(2);
la3 = lambda(3);
la4 = lambda(4);
         
                         
Dphip(:,:,1) = 18.*Da1.*la3 - 90.*Da1.*la2 - 90.*Da2.*la1 - 18.*Da1.*la1 + 18.*Da2.*la2 + 18.*Da3.*la1...
                                 + 18.*Da1.*la4 + 6.*Da2.*la3 + 6.*Da3.*la2 + 18.*Da4.*la1 + 6.*Da2.*la4 - 6.*Da3.*la3 ...
                                 + 6.*Da4.*la2 - 6.*Da3.*la4 - 6.*Da4.*la3 - 6.*Da4.*la4 + 180.*Da2.*la1.^2 + 360.*Da1.*la1.*la2;
                             
Dphip(:,:,2) =  48.*Da1.*la3 + 48.*Da3.*la1 - 12.*Da2.*la3 - 12.*Da3.*la2 + 36.*Da3.*la3 - 12.*Da3.*la4 ...
                                - 12.*Da4.*la3 - 180.*Da1.*la3.^2 - 360.*Da3.*la1.*la3;
                            
Dphip(:,:,3) =  36.*Da1.*la1 + 72.*Da1.*la2 + 72.*Da2.*la1 - 84.*Da1.*la3 - 12.*Da2.*la2 - 84.*Da3.*la1 ...
                                - 36.*Da1.*la4 + 12.*Da2.*la3 + 12.*Da3.*la2 - 36.*Da4.*la1 - 24.*Da3.*la3 + 24.*Da3.*la4 ...
                                + 24.*Da4.*la3 + 12.*Da4.*la4 - 180.*Da2.*la1.^2 + 180.*Da1.*la3.^2 - 360.*Da1.*la1.*la2 + 360*Da3.*la1.*la3;
                            
 Dphip(:,:,4)  = 18.*Da1.*la2 - 6.*Da1.*la1 + 18.*Da2.*la1 + 6.*Da1.*la3 - 18.*Da2.*la2 + 6.*Da3.*la1 -...
                                 6.*Da1.*la4 - 90.*Da2.*la3 - 90.*Da3.*la2 - 6.*Da4.*la1 + 18.*Da2.*la4 + 18.*Da3.*la3 ...
                                 + 18.*Da4.*la2 + 6.*Da3.*la4 + 6.*Da4.*la3 - 6.*Da4.*la4 + 180.*Da3.*la2.^2 + 360.*Da2.*la2.*la3;
                             
Dphip(:,:,5)  =  12.*Da1.*la3 - 84.*Da1.*la2 - 84.*Da2.*la1 - 24.*Da1.*la1 + 36.*Da2.*la2 + 12.*Da3.*la1 ...
                                 + 24.*Da1.*la4 + 72.*Da2.*la3 + 72.*Da3.*la2 + 24.*Da4.*la1 - 36.*Da2.*la4 - 12.*Da3.*la3 ...
                                 - 36.*Da4.*la2 + 12.*Da4.*la4 + 180.*Da2.*la1.^2 - 180.*Da3.*la2.^2 + 360.*Da1.*la1.*la2 - 360.*Da2.*la2.*la3;
                             
Dphip(:,:,6)  = 36.*Da1.*la1 + 48.*Da1.*la2 + 48.*Da2.*la1 - 12.*Da1.*la3 - 12.*Da3.*la1 - 12.*Da1.*la4 ...
                                 - 12.*Da4.*la1 - 180.*Da2.*la1.^2 - 360.*Da1.*la1.*la2;
                                                     
 Dphip(:,:,7)  = 12.*Da1.*la2 - 12.*Da1.*la1 + 12.*Da2.*la1 + 72.*Da1.*la3 - 24.*Da2.*la2 + 72.*Da3.*la1...
                                  - 84.*Da2.*la3 - 84.*Da3.*la2 + 24.*Da2.*la4 + 36.*Da3.*la3 + 24.*Da4.*la2 - 36.*Da3.*la4...
                                  - 36.*Da4.*la3 + 12.*Da4.*la4 - 180.*Da1.*la3.^2 + 180.*Da3.*la2.^2 + 360.*Da2.*la2.*la3 - 360.*Da3.*la1.*la3;
                              
Dphip(:,:,8)  = 18.*Da1.*la1 + 6.*Da1.*la2 + 6.*Da2.*la1 - 90.*Da1.*la3 - 6.*Da2.*la2 - 90.*Da3.*la1 ...
                                  + 6.*Da1.*la4 + 18.*Da2.*la3 + 18.*Da3.*la2 + 6.*Da4.*la1 - 6.*Da2*la4 - 18.*Da3*la3 ... 
                                  - 6.*Da4.*la2 + 18.*Da3.*la4 + 18.*Da4.*la3 - 6.*Da4.*la4 + 180.*Da1.*la3.^2 + 360.*Da3.*la1.*la3;
                              
Dphip(:,:,9)  = 36.*Da2.*la2 - 12.*Da2.*la1 - 12.*Da1.*la2 + 48.*Da2.*la3 + 48.*Da3.*la2 - 12.*Da2.*la4...
                                  - 12.*Da4.*la2 - 180.*Da3.*la2.^2 - 360.*Da2.*la2.*la3;
                          
Dphip(:,:,10)  = 90.*Da1.*la3 - 66.*Da1.*la2 - 66.*Da2.*la1 - 18.*Da1.*la1 + 6.*Da2.*la2 + 90.*Da3.*la1...
                                    - 6.*Da1.*la4 - 18.*Da2.*la3 - 18.*Da3.*la2 - 6.*Da4.*la1 + 6.*Da2.*la4 + 18.*Da3.*la3 ...
                                    + 6.*Da4.*la2 - 18.*Da3.*la4 - 18.*Da4.*la3 + 6.*Da4.*la4 + 180.*Da2.*la1.^2 ...
                                    - 180.*Da1.*la3.^2 + 360.*Da1.*la1.*la2 - 360.*Da3.*la1.*la3;
                                
Dphip(:,:,11)  =  18.*Da1.*la1 + 90.*Da1.*la2 + 90.*Da2.*la1 - 18.*Da1.*la3 - 18.*Da2.*la2 - 18.*Da3.*la1...
                                   - 18.*Da1.*la4 - 66.*Da2.*la3 - 66.*Da3.*la2 - 18.*Da4.*la1 - 6.*Da2.*la4 + 6.*Da3.*la3 ...
                                   - 6.*Da4.*la2 + 6.*Da3.*la4 + 6.*Da4.*la3 + 6.*Da4.*la4 - 180.*Da2.*la1.^2 + 180.*Da3.*la2.^2 ...
                                   - 360.*Da1.*la1.*la2 + 360.*Da2.*la2.*la3;
                                
Dphip(:,:,12)  =  6.*Da1.*la1 - 18.*Da1.*la2 - 18.*Da2.*la1 - 66.*Da1.*la3 + 18.*Da2.*la2 - 66.*Da3.*la1...
                                  + 6.*Da1.*la4 + 90.*Da2.*la3 + 90.*Da3.*la2 + 6.*Da4.*la1 - 18.*Da2.*la4 - 18.*Da3.*la3 ...
                                  - 18.*Da4.*la2 - 6.*Da3.*la4 - 6.*Da4.*la3 + 6.*Da4.*la4 + 180.*Da1.*la3^2 - 180.*Da3.*la2.^2 ...
                                  - 360.*Da2.*la2.*la3 + 360.*Da3.*la1.*la3;

Dphip(:,:,13) =  10.*Da1.*la2 - 10.*Da1.*la1 + 10.*Da2.*la1 + 10.*Da1.*la3 - 10.*Da2.*la2 + 10.*Da3.*la1...
                                + 10.*Da1.*la4 + 10.*Da2.*la3 + 10.*Da3.*la2 + 10.*Da4.*la1 + 10.*Da2.*la4 - 10.*Da3.*la3...
                                + 10.*Da4.*la2 + 10.*Da3.*la4 + 10.*Da4.*la3 - 10.*Da4.*la4;

end
